<!DOCTYPE html>
<html lang="vi">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Đăng Ký</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: "Inter", sans-serif;
		}

		body {
			background: linear-gradient(135deg, #e0f2ff, #fdfdfd);
			display: flex;
			justify-content: center;
			align-items: center;
			height: 100vh;
			overflow: hidden;
		}

		.register-container {
			position: relative;
			background: #fff;
			padding: 40px 30px;
			border-radius: 16px;
			box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
			width: 100%;
			max-width: 420px;
			z-index: 2;
		}

		.form-title {
			text-align: center;
			margin-bottom: 25px;
			font-size: 22px;
			font-weight: 600;
			color: #333;
		}

		.form-group {
			margin-bottom: 18px;
		}

		.form-group label {
			display: block;
			margin-bottom: 6px;
			font-weight: 500;
			color: #555;
		}

		.form-group input {
			width: 100%;
			padding: 12px;
			border: 1.5px solid #ccc;
			border-radius: 10px;
			font-size: 15px;
			transition: all 0.3s ease;
		}

		.form-group input:focus {
			border-color: #2575fc;
			box-shadow: 0 0 6px rgba(37, 117, 252, 0.3);
			outline: none;
		}

		.gender-options {
			display: flex;
			gap: 10px;
		}

		.gender-btn {
			flex: 1;
			padding: 10px 0;
			border: 1.5px solid #ccc;
			border-radius: 10px;
			background: #f8f9fa;
			cursor: pointer;
			transition: all 0.3s ease;
		}

		.gender-btn:hover,
		.gender-btn.active {
			background: #2575fc;
			color: #fff;
			border-color: #2575fc;
		}

		.register-button {
			width: 100%;
			padding: 14px;
			border: none;
			border-radius: 12px;
			background: linear-gradient(135deg, #6a11cb, #2575fc);
			color: #fff;
			font-size: 16px;
			font-weight: 600;
			cursor: pointer;
			transition: transform 0.2s ease, box-shadow 0.2s ease;
		}

		.register-button:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);
		}

		.bank-icon {
			position: fixed;
			top: -80px;
			color: rgba(182, 182, 182, 0.853);
			animation: fall linear forwards;
			z-index: 1;
			pointer-events: none;
		}

		@keyframes fall {
			to {
				transform: translateY(110vh) rotate(360deg);
				opacity: 0;
			}
		}

		/* Nút HOME */
		.home-btn {
			position: fixed;
			top: 16px;
			left: 16px;
			z-index: 50;
			display: flex;
			align-items: center;
			gap: 6px;
			background: #fff;
			padding: 8px 12px;
			border-radius: 9999px;
			color: #2563eb;
			font-weight: 600;
			text-decoration: none;
			box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
			transition: all 0.2s ease;
		}

		.home-btn:hover {
			background: #eff6ff;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
		}

		.home-btn svg {
			width: 20px;
			height: 20px;
		}
	</style>
</head>

<body>
	<!-- Nút HOME -->
	<a href="http://localhost:8081/page/home" class="home-btn">
		<svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
			<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
				d="M3 12l2-2m0 0l7-7 7 7m-9 2v8m-4 4h16a2 2 0 002-2v-8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
		</svg>
		HOME
	</a>

	<div class="register-container">
		<form class="register-form">
			<h2 class="form-title">Đăng Ký Tài Khoản</h2>
			<div class="form-group">
				<label>Họ tên</label>
				<input type="text" id="fullName" placeholder="Nhập họ tên..." required>
			</div>
			<div class="form-group">
				<label>Email</label>
				<input type="email" id="email" placeholder="Nhập email..." required>
			</div>
			<div class="form-group">
				<label>Điện thoại</label>
				<input type="tel" id="phoneNumber" placeholder="Nhập số điện thoại..." required>
			</div>
			<div class="form-group">
				<label>Tên đăng nhập</label>
				<input type="text" id="username" placeholder="Nhập username..." required>
			</div>
			<div class="form-group">
				<label>Giới tính</label>
				<div class="gender-options">
					<button type="button" class="gender-btn" data-value="Nam">Nam</button>
					<button type="button" class="gender-btn" data-value="Nữ">Nữ</button>
				</div>
			</div>
			<div class="form-group">
				<label>Mật khẩu</label>
				<input type="password" id="password" placeholder="Nhập mật khẩu..." required>
			</div>
			<button type="submit" class="register-button">Đăng ký</button>
		</form>
	</div>

	<script>
		// Xử lý chọn giới tính
		let selectedGender = "";
		const genderButtons = document.querySelectorAll('.gender-btn');
		genderButtons.forEach(btn => {
			btn.addEventListener('click', () => {
				genderButtons.forEach(b => b.classList.remove('active'));
				btn.classList.add('active');
				selectedGender = btn.dataset.value;
			});
		});

		// Submit form => gọi API
		
		document.querySelector('.register-form').addEventListener('submit', async (e) => {
			e.preventDefault();
			const data = {
				fullName: document.getElementById('fullName').value,
				email: document.getElementById('email').value,
				phoneNumber: document.getElementById('phoneNumber').value,
				username: document.getElementById('username').value,
				password: document.getElementById('password').value,
				gender: selectedGender
			};
			try {
				const res = await fetch("http://localhost:8081/api/v1/auth/register", {
					method: "POST",
					headers: {
						"Content-Type": "application/json"
					},
					body: JSON.stringify(data)
				});
				if (res.ok) {
					alert("Đăng ký thành công!");
					window.location.href = "http://localhost:8081/page/home";
				} else {
					const err = await res.json();
					if (err?.message?.includes("same.email")) {
						alert("Email đã tồn tại!");
						return;
					}
					alert("Đăng ký thất bại: " + (err?.message || JSON.stringify(err)));
				}
			} catch (error) {
				alert("Lỗi kết nối server: " + error);
			}
		});


		// Hiệu ứng icon rơi
		const icons = ["fa-university", "fa-credit-card", "fa-coins", "fa-piggy-bank", "fa-chart-line", "fa-wallet", "fa-money-check-alt", "fa-landmark", "fa-dollar-sign"];
		function createFallingIcon() {
			const icon = document.createElement("i");
			icon.classList.add("fas", icons[Math.floor(Math.random() * icons.length)], "bank-icon");
			icon.style.left = Math.random() * 95 + "%";
			icon.style.fontSize = (50 + Math.random() * 15) + "px";
			const duration = 5 + Math.random() * 5;
			icon.style.animationDuration = duration + "s";
			document.body.appendChild(icon);
			setTimeout(() => icon.remove(), duration * 1000);
		}
		setInterval(createFallingIcon, 2000);
	</script>
</body>

</html>